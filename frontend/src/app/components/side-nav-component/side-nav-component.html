<mat-sidenav-container class="sidenav-container">
  <mat-sidenav #drawer id="app-sidenav" mode="side" opened position="start" class="sidenav">
    <mat-toolbar class="sidenav-header">
      <button
        mat-icon-button
        type="button"
        aria-label="Toggle menu"
        (click)="drawer.toggle()"
        [attr.aria-controls]="'app-sidenav'"
        [attr.aria-expanded]="drawer.opened"
      >
        <mat-icon>menu_open</mat-icon>
      </button>
      <span class="app-title">Bank Tracker</span>
    </mat-toolbar>

    <div class="sidenav-content">
      <nav aria-label="Main navigation">
        <mat-accordion class="nav-accordion" multi>
          <!-- Home Section -->
          <mat-expansion-panel [(expanded)]="homeExpanded" class="nav-panel">
            <mat-expansion-panel-header>
              <mat-panel-title class="panel-title">
                <mat-icon class="panel-icon">home</mat-icon>
                <span>Home</span>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-nav-list dense>
              <a
                mat-list-item
                routerLink="/home/dashboard"
                routerLinkActive="active-link"
                [routerLinkActiveOptions]="{ exact: true }"
              >
                <mat-icon matListItemIcon>dashboard</mat-icon>
                <span matListItemTitle>Dashboard</span>
              </a>
              <a
                mat-list-item
                routerLink="/home/balance"
                routerLinkActive="active-link"
                [routerLinkActiveOptions]="{ exact: true }"
              >
                <mat-icon matListItemIcon>account_balance_wallet</mat-icon>
                <span matListItemTitle>Balance</span>
              </a>
            </mat-nav-list>
          </mat-expansion-panel>

          <!-- Movements Section -->
          <mat-expansion-panel [(expanded)]="movementsExpanded" class="nav-panel">
            <mat-expansion-panel-header>
              <mat-panel-title class="panel-title">
                <mat-icon class="panel-icon">insights</mat-icon>
                <span>Movements</span>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-nav-list dense>
              <a
                mat-list-item
                routerLink="/movements/tracking"
                routerLinkActive="active-link"
                [routerLinkActiveOptions]="{ exact: true }"
              >
                <mat-icon matListItemIcon>receipt_long</mat-icon>
                <span matListItemTitle>Tracking</span>
              </a>
              <a
                mat-list-item
                routerLink="/movements/import"
                routerLinkActive="active-link"
                [routerLinkActiveOptions]="{ exact: true }"
              >
                <mat-icon matListItemIcon>upload_file</mat-icon>
                <span matListItemTitle>Import</span>
              </a>
            </mat-nav-list>
          </mat-expansion-panel>

          <!-- Analytics Section -->
          <mat-expansion-panel [(expanded)]="analyticsExpanded" class="nav-panel">
            <mat-expansion-panel-header>
              <mat-panel-title class="panel-title">
                <mat-icon class="panel-icon">analytics</mat-icon>
                <span>Analytics</span>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-nav-list dense>
              <a
                mat-list-item
                routerLink="/analytics/monthly-comparison"
                routerLinkActive="active-link"
                [routerLinkActiveOptions]="{ exact: true }"
              >
                <mat-icon matListItemIcon>calendar_month</mat-icon>
                <span matListItemTitle>Month by Month</span>
              </a>
            </mat-nav-list>
          </mat-expansion-panel>
        </mat-accordion>
      </nav>

      <mat-divider></mat-divider>

      <mat-nav-list aria-label="Account actions" class="account-actions">
        <a mat-list-item (click)="onToggleTheme()" (keydown.enter)="onToggleTheme()" (keydown.space)="onToggleTheme(); $event.preventDefault()" tabindex="0" role="button">
          <mat-icon matListItemIcon>
            @if (themeService.isDarkMode()) {
              light_mode
            } @else {
              dark_mode
            }
          </mat-icon>
          <span matListItemTitle>
            @if (themeService.isDarkMode()) {
              Light Mode
            } @else {
              Dark Mode
            }
          </span>
        </a>
        <a
          mat-list-item
          #rlaSettings="routerLinkActive"
          routerLink="/settings"
          routerLinkActive="active-link"
          [attr.aria-current]="rlaSettings.isActive ? 'page' : null"
        >
          <mat-icon matListItemIcon>settings</mat-icon>
          <span matListItemTitle>Settings</span>
        </a>
        <a mat-list-item (click)="onLogout()" (keydown.enter)="onLogout()" (keydown.space)="onLogout(); $event.preventDefault()" tabindex="0" role="button">
          <mat-icon matListItemIcon>logout</mat-icon>
          <span matListItemTitle>Logout</span>
        </a>
      </mat-nav-list>
    </div>
  </mat-sidenav>

  <mat-sidenav-content class="sidenav-main-content">
    @if (!drawer.opened) {
      <mat-toolbar class="mobile-toolbar">
        <button
          mat-icon-button
          type="button"
          aria-label="Open menu"
          (click)="drawer.toggle()"
          [attr.aria-controls]="'app-sidenav'"
          [attr.aria-expanded]="drawer.opened"
        >
          <mat-icon>menu</mat-icon>
        </button>
        <app-breadcrumb class="breadcrumb closed"></app-breadcrumb>
      </mat-toolbar>
    }
    <div class="content-wrapper">
      @if (drawer.opened) {
        <app-breadcrumb class="breadcrumb open"></app-breadcrumb>
      }
      <ng-content></ng-content>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
